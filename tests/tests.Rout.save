
R version 2.4.1 (2006-12-18)
Copyright (C) 2006 The R Foundation for Statistical Computing
ISBN 3-900051-07-0

R is free software and comes with ABSOLUTELY NO WARRANTY.
You are welcome to redistribute it under certain conditions.
Type 'license()' or 'licence()' for distribution details.

R is a collaborative project with many contributors.
Type 'contributors()' for more information and
'citation()' on how to cite R or R packages in publications.

Type 'demo()' for some demos, 'help()' for on-line help, or
'help.start()' for an HTML browser interface to help.
Type 'q()' to quit R.

> 
> # gee support @(#) tests.q 1.2 96/09/27
> 
> library(gee)
> 
> source("testgee.dump")
> 
> myr <- gee(gsind~x2+x3+x4,id=id,data=testgee)
Beginning Cgee S-function, @(#) geeformula.q 4.13 98/01/27
running glm to get initial regression estimate
(Intercept)          x2          x3          x4 
  0.8107414   2.2933133  -1.1806841   1.4415174 
> myr

 GEE:  GENERALIZED LINEAR MODELS FOR DEPENDENT DATA
 gee S-function, version 4.13 modified 98/01/27 (1998) 

Model:
 Link:                      Identity 
 Variance to Mean Relation: Gaussian 
 Correlation Structure:     Independent 

Call:
gee(formula = gsind ~ x2 + x3 + x4, id = id, data = testgee)

Number of observations :  500 

Maximum cluster size   :  20 


Coefficients:
(Intercept)          x2          x3          x4 
  0.8107414   2.2933133  -1.1806841   1.4415174 

Estimated Scale Parameter:  2.899625
Number of Iterations:  1

Working Correlation[1:4,1:4]
     [,1] [,2] [,3] [,4]
[1,]    1    0    0    0
[2,]    0    1    0    0
[3,]    0    0    1    0
[4,]    0    0    0    1


Returned Error Value:
[1] 0
> summary(myr)

 GEE:  GENERALIZED LINEAR MODELS FOR DEPENDENT DATA
 gee S-function, version 4.13 modified 98/01/27 (1998) 

Model:
 Link:                      Identity 
 Variance to Mean Relation: Gaussian 
 Correlation Structure:     Independent 

Call:
gee(formula = gsind ~ x2 + x3 + x4, id = id, data = testgee)

Summary of Residuals:
        Min          1Q      Median          3Q         Max 
-5.12638044 -1.17212201  0.07530777  1.13873892  5.69264860 


Coefficients:
              Estimate Naive S.E.    Naive z Robust S.E.   Robust z
(Intercept)  0.8107414 0.75420946   1.074955  0.76905602   1.054203
x2           2.2933133 0.04546161  50.445055  0.04589797  49.965459
x3          -1.1806841 0.05974921 -19.760664  0.06847056 -17.243677
x4           1.4415174 0.03154513  45.696983  0.03153448  45.712418

Estimated Scale Parameter:  2.899625
Number of Iterations:  1

Working Correlation
      [,1] [,2] [,3] [,4] [,5] [,6] [,7] [,8] [,9] [,10] [,11] [,12] [,13]
 [1,]    1    0    0    0    0    0    0    0    0     0     0     0     0
 [2,]    0    1    0    0    0    0    0    0    0     0     0     0     0
 [3,]    0    0    1    0    0    0    0    0    0     0     0     0     0
 [4,]    0    0    0    1    0    0    0    0    0     0     0     0     0
 [5,]    0    0    0    0    1    0    0    0    0     0     0     0     0
 [6,]    0    0    0    0    0    1    0    0    0     0     0     0     0
 [7,]    0    0    0    0    0    0    1    0    0     0     0     0     0
 [8,]    0    0    0    0    0    0    0    1    0     0     0     0     0
 [9,]    0    0    0    0    0    0    0    0    1     0     0     0     0
[10,]    0    0    0    0    0    0    0    0    0     1     0     0     0
[11,]    0    0    0    0    0    0    0    0    0     0     1     0     0
[12,]    0    0    0    0    0    0    0    0    0     0     0     1     0
[13,]    0    0    0    0    0    0    0    0    0     0     0     0     1
[14,]    0    0    0    0    0    0    0    0    0     0     0     0     0
[15,]    0    0    0    0    0    0    0    0    0     0     0     0     0
[16,]    0    0    0    0    0    0    0    0    0     0     0     0     0
[17,]    0    0    0    0    0    0    0    0    0     0     0     0     0
[18,]    0    0    0    0    0    0    0    0    0     0     0     0     0
[19,]    0    0    0    0    0    0    0    0    0     0     0     0     0
[20,]    0    0    0    0    0    0    0    0    0     0     0     0     0
      [,14] [,15] [,16] [,17] [,18] [,19] [,20]
 [1,]     0     0     0     0     0     0     0
 [2,]     0     0     0     0     0     0     0
 [3,]     0     0     0     0     0     0     0
 [4,]     0     0     0     0     0     0     0
 [5,]     0     0     0     0     0     0     0
 [6,]     0     0     0     0     0     0     0
 [7,]     0     0     0     0     0     0     0
 [8,]     0     0     0     0     0     0     0
 [9,]     0     0     0     0     0     0     0
[10,]     0     0     0     0     0     0     0
[11,]     0     0     0     0     0     0     0
[12,]     0     0     0     0     0     0     0
[13,]     0     0     0     0     0     0     0
[14,]     1     0     0     0     0     0     0
[15,]     0     1     0     0     0     0     0
[16,]     0     0     1     0     0     0     0
[17,]     0     0     0     1     0     0     0
[18,]     0     0     0     0     1     0     0
[19,]     0     0     0     0     0     1     0
[20,]     0     0     0     0     0     0     1
> summary(gee(gs~x2+x4,id=id,data=testgee,corstr="exchangeable"))
Beginning Cgee S-function, @(#) geeformula.q 4.13 98/01/27
running glm to get initial regression estimate
(Intercept)          x2          x4 
 -21.504384    4.643727    3.065537 

 GEE:  GENERALIZED LINEAR MODELS FOR DEPENDENT DATA
 gee S-function, version 4.13 modified 98/01/27 (1998) 

Model:
 Link:                      Identity 
 Variance to Mean Relation: Gaussian 
 Correlation Structure:     Exchangeable 

Call:
gee(formula = gs ~ x2 + x4, id = id, data = testgee, corstr = "exchangeable")

Summary of Residuals:
        Min          1Q      Median          3Q         Max 
-32.6076365  -9.8240277   0.4309459  10.2768319  44.8278747 


Coefficients:
              Estimate Naive S.E.  Naive z Robust S.E.  Robust z
(Intercept) -21.675077  3.7046983 -5.85070   3.5007586 -6.191537
x2            4.676098  0.3786822 12.34835   0.3336659 14.014313
x4            3.057583  0.2632230 11.61594   0.2251384 13.580903

Estimated Scale Parameter:  202.3612
Number of Iterations:  2

Working Correlation
             [,1]        [,2]        [,3]        [,4]        [,5]        [,6]
 [1,]  1.00000000 -0.01037861 -0.01037861 -0.01037861 -0.01037861 -0.01037861
 [2,] -0.01037861  1.00000000 -0.01037861 -0.01037861 -0.01037861 -0.01037861
 [3,] -0.01037861 -0.01037861  1.00000000 -0.01037861 -0.01037861 -0.01037861
 [4,] -0.01037861 -0.01037861 -0.01037861  1.00000000 -0.01037861 -0.01037861
 [5,] -0.01037861 -0.01037861 -0.01037861 -0.01037861  1.00000000 -0.01037861
 [6,] -0.01037861 -0.01037861 -0.01037861 -0.01037861 -0.01037861  1.00000000
 [7,] -0.01037861 -0.01037861 -0.01037861 -0.01037861 -0.01037861 -0.01037861
 [8,] -0.01037861 -0.01037861 -0.01037861 -0.01037861 -0.01037861 -0.01037861
 [9,] -0.01037861 -0.01037861 -0.01037861 -0.01037861 -0.01037861 -0.01037861
[10,] -0.01037861 -0.01037861 -0.01037861 -0.01037861 -0.01037861 -0.01037861
[11,] -0.01037861 -0.01037861 -0.01037861 -0.01037861 -0.01037861 -0.01037861
[12,] -0.01037861 -0.01037861 -0.01037861 -0.01037861 -0.01037861 -0.01037861
[13,] -0.01037861 -0.01037861 -0.01037861 -0.01037861 -0.01037861 -0.01037861
[14,] -0.01037861 -0.01037861 -0.01037861 -0.01037861 -0.01037861 -0.01037861
[15,] -0.01037861 -0.01037861 -0.01037861 -0.01037861 -0.01037861 -0.01037861
[16,] -0.01037861 -0.01037861 -0.01037861 -0.01037861 -0.01037861 -0.01037861
[17,] -0.01037861 -0.01037861 -0.01037861 -0.01037861 -0.01037861 -0.01037861
[18,] -0.01037861 -0.01037861 -0.01037861 -0.01037861 -0.01037861 -0.01037861
[19,] -0.01037861 -0.01037861 -0.01037861 -0.01037861 -0.01037861 -0.01037861
[20,] -0.01037861 -0.01037861 -0.01037861 -0.01037861 -0.01037861 -0.01037861
             [,7]        [,8]        [,9]       [,10]       [,11]       [,12]
 [1,] -0.01037861 -0.01037861 -0.01037861 -0.01037861 -0.01037861 -0.01037861
 [2,] -0.01037861 -0.01037861 -0.01037861 -0.01037861 -0.01037861 -0.01037861
 [3,] -0.01037861 -0.01037861 -0.01037861 -0.01037861 -0.01037861 -0.01037861
 [4,] -0.01037861 -0.01037861 -0.01037861 -0.01037861 -0.01037861 -0.01037861
 [5,] -0.01037861 -0.01037861 -0.01037861 -0.01037861 -0.01037861 -0.01037861
 [6,] -0.01037861 -0.01037861 -0.01037861 -0.01037861 -0.01037861 -0.01037861
 [7,]  1.00000000 -0.01037861 -0.01037861 -0.01037861 -0.01037861 -0.01037861
 [8,] -0.01037861  1.00000000 -0.01037861 -0.01037861 -0.01037861 -0.01037861
 [9,] -0.01037861 -0.01037861  1.00000000 -0.01037861 -0.01037861 -0.01037861
[10,] -0.01037861 -0.01037861 -0.01037861  1.00000000 -0.01037861 -0.01037861
[11,] -0.01037861 -0.01037861 -0.01037861 -0.01037861  1.00000000 -0.01037861
[12,] -0.01037861 -0.01037861 -0.01037861 -0.01037861 -0.01037861  1.00000000
[13,] -0.01037861 -0.01037861 -0.01037861 -0.01037861 -0.01037861 -0.01037861
[14,] -0.01037861 -0.01037861 -0.01037861 -0.01037861 -0.01037861 -0.01037861
[15,] -0.01037861 -0.01037861 -0.01037861 -0.01037861 -0.01037861 -0.01037861
[16,] -0.01037861 -0.01037861 -0.01037861 -0.01037861 -0.01037861 -0.01037861
[17,] -0.01037861 -0.01037861 -0.01037861 -0.01037861 -0.01037861 -0.01037861
[18,] -0.01037861 -0.01037861 -0.01037861 -0.01037861 -0.01037861 -0.01037861
[19,] -0.01037861 -0.01037861 -0.01037861 -0.01037861 -0.01037861 -0.01037861
[20,] -0.01037861 -0.01037861 -0.01037861 -0.01037861 -0.01037861 -0.01037861
            [,13]       [,14]       [,15]       [,16]       [,17]       [,18]
 [1,] -0.01037861 -0.01037861 -0.01037861 -0.01037861 -0.01037861 -0.01037861
 [2,] -0.01037861 -0.01037861 -0.01037861 -0.01037861 -0.01037861 -0.01037861
 [3,] -0.01037861 -0.01037861 -0.01037861 -0.01037861 -0.01037861 -0.01037861
 [4,] -0.01037861 -0.01037861 -0.01037861 -0.01037861 -0.01037861 -0.01037861
 [5,] -0.01037861 -0.01037861 -0.01037861 -0.01037861 -0.01037861 -0.01037861
 [6,] -0.01037861 -0.01037861 -0.01037861 -0.01037861 -0.01037861 -0.01037861
 [7,] -0.01037861 -0.01037861 -0.01037861 -0.01037861 -0.01037861 -0.01037861
 [8,] -0.01037861 -0.01037861 -0.01037861 -0.01037861 -0.01037861 -0.01037861
 [9,] -0.01037861 -0.01037861 -0.01037861 -0.01037861 -0.01037861 -0.01037861
[10,] -0.01037861 -0.01037861 -0.01037861 -0.01037861 -0.01037861 -0.01037861
[11,] -0.01037861 -0.01037861 -0.01037861 -0.01037861 -0.01037861 -0.01037861
[12,] -0.01037861 -0.01037861 -0.01037861 -0.01037861 -0.01037861 -0.01037861
[13,]  1.00000000 -0.01037861 -0.01037861 -0.01037861 -0.01037861 -0.01037861
[14,] -0.01037861  1.00000000 -0.01037861 -0.01037861 -0.01037861 -0.01037861
[15,] -0.01037861 -0.01037861  1.00000000 -0.01037861 -0.01037861 -0.01037861
[16,] -0.01037861 -0.01037861 -0.01037861  1.00000000 -0.01037861 -0.01037861
[17,] -0.01037861 -0.01037861 -0.01037861 -0.01037861  1.00000000 -0.01037861
[18,] -0.01037861 -0.01037861 -0.01037861 -0.01037861 -0.01037861  1.00000000
[19,] -0.01037861 -0.01037861 -0.01037861 -0.01037861 -0.01037861 -0.01037861
[20,] -0.01037861 -0.01037861 -0.01037861 -0.01037861 -0.01037861 -0.01037861
            [,19]       [,20]
 [1,] -0.01037861 -0.01037861
 [2,] -0.01037861 -0.01037861
 [3,] -0.01037861 -0.01037861
 [4,] -0.01037861 -0.01037861
 [5,] -0.01037861 -0.01037861
 [6,] -0.01037861 -0.01037861
 [7,] -0.01037861 -0.01037861
 [8,] -0.01037861 -0.01037861
 [9,] -0.01037861 -0.01037861
[10,] -0.01037861 -0.01037861
[11,] -0.01037861 -0.01037861
[12,] -0.01037861 -0.01037861
[13,] -0.01037861 -0.01037861
[14,] -0.01037861 -0.01037861
[15,] -0.01037861 -0.01037861
[16,] -0.01037861 -0.01037861
[17,] -0.01037861 -0.01037861
[18,] -0.01037861 -0.01037861
[19,]  1.00000000 -0.01037861
[20,] -0.01037861  1.00000000
> 
> summary(gee(gsind~sin(x2)+log(x3)+x4,id=id,data=testgee))
Beginning Cgee S-function, @(#) geeformula.q 4.13 98/01/27
running glm to get initial regression estimate
(Intercept)     sin(x2)     log(x3)          x4 
  33.017960    1.235559  -12.033930    1.500485 

 GEE:  GENERALIZED LINEAR MODELS FOR DEPENDENT DATA
 gee S-function, version 4.13 modified 98/01/27 (1998) 

Model:
 Link:                      Identity 
 Variance to Mean Relation: Gaussian 
 Correlation Structure:     Independent 

Call:
gee(formula = gsind ~ sin(x2) + log(x3) + x4, id = id, data = testgee)

Summary of Residuals:
        Min          1Q      Median          3Q         Max 
-14.2099238  -2.6510967  -0.4994671   2.1403832  12.8126774 


Coefficients:
              Estimate Naive S.E.   Naive z Robust S.E.  Robust z
(Intercept)  33.017960 3.39110198  9.736646  3.03682905 10.872512
sin(x2)       1.235559 0.26662685  4.634036  0.44529003  2.774728
log(x3)     -12.033930 1.43540337 -8.383657  1.33255574 -9.030714
x4            1.500485 0.07638601 19.643451  0.06166767 24.331791

Estimated Scale Parameter:  17.02534
Number of Iterations:  1

Working Correlation
      [,1] [,2] [,3] [,4] [,5] [,6] [,7] [,8] [,9] [,10] [,11] [,12] [,13]
 [1,]    1    0    0    0    0    0    0    0    0     0     0     0     0
 [2,]    0    1    0    0    0    0    0    0    0     0     0     0     0
 [3,]    0    0    1    0    0    0    0    0    0     0     0     0     0
 [4,]    0    0    0    1    0    0    0    0    0     0     0     0     0
 [5,]    0    0    0    0    1    0    0    0    0     0     0     0     0
 [6,]    0    0    0    0    0    1    0    0    0     0     0     0     0
 [7,]    0    0    0    0    0    0    1    0    0     0     0     0     0
 [8,]    0    0    0    0    0    0    0    1    0     0     0     0     0
 [9,]    0    0    0    0    0    0    0    0    1     0     0     0     0
[10,]    0    0    0    0    0    0    0    0    0     1     0     0     0
[11,]    0    0    0    0    0    0    0    0    0     0     1     0     0
[12,]    0    0    0    0    0    0    0    0    0     0     0     1     0
[13,]    0    0    0    0    0    0    0    0    0     0     0     0     1
[14,]    0    0    0    0    0    0    0    0    0     0     0     0     0
[15,]    0    0    0    0    0    0    0    0    0     0     0     0     0
[16,]    0    0    0    0    0    0    0    0    0     0     0     0     0
[17,]    0    0    0    0    0    0    0    0    0     0     0     0     0
[18,]    0    0    0    0    0    0    0    0    0     0     0     0     0
[19,]    0    0    0    0    0    0    0    0    0     0     0     0     0
[20,]    0    0    0    0    0    0    0    0    0     0     0     0     0
      [,14] [,15] [,16] [,17] [,18] [,19] [,20]
 [1,]     0     0     0     0     0     0     0
 [2,]     0     0     0     0     0     0     0
 [3,]     0     0     0     0     0     0     0
 [4,]     0     0     0     0     0     0     0
 [5,]     0     0     0     0     0     0     0
 [6,]     0     0     0     0     0     0     0
 [7,]     0     0     0     0     0     0     0
 [8,]     0     0     0     0     0     0     0
 [9,]     0     0     0     0     0     0     0
[10,]     0     0     0     0     0     0     0
[11,]     0     0     0     0     0     0     0
[12,]     0     0     0     0     0     0     0
[13,]     0     0     0     0     0     0     0
[14,]     1     0     0     0     0     0     0
[15,]     0     1     0     0     0     0     0
[16,]     0     0     1     0     0     0     0
[17,]     0     0     0     1     0     0     0
[18,]     0     0     0     0     1     0     0
[19,]     0     0     0     0     0     1     0
[20,]     0     0     0     0     0     0     1
> #summary(gee(gsind~gam(x2~x1)$fitted.values+x4,id=id,data=testgee,subset=id<20))
> 
> summary(gee(lgind~x2+x3+x4,id=id,data=testgee,family=binomial))
Beginning Cgee S-function, @(#) geeformula.q 4.13 98/01/27
running glm to get initial regression estimate
(Intercept)          x2          x3          x4 
 4.72920874 -0.34747871 -0.21939993 -0.07103635 

 GEE:  GENERALIZED LINEAR MODELS FOR DEPENDENT DATA
 gee S-function, version 4.13 modified 98/01/27 (1998) 

Model:
 Link:                      Logit 
 Variance to Mean Relation: Binomial 
 Correlation Structure:     Independent 

Call:
gee(formula = lgind ~ x2 + x3 + x4, id = id, data = testgee, 
    family = binomial)

Summary of Residuals:
       Min         1Q     Median         3Q        Max 
-0.7537945 -0.3323381 -0.2080574  0.5160616  0.8872020 


Coefficients:
               Estimate Naive S.E.   Naive z Robust S.E.  Robust z
(Intercept)  4.72920874 1.03210192  4.582114  0.86323313  5.478484
x2          -0.34747871 0.06301385 -5.514323  0.05004796 -6.942915
x3          -0.21939993 0.07952035 -2.759041  0.07725222 -2.840047
x4          -0.07103635 0.04152051 -1.710874  0.03167549 -2.242628

Estimated Scale Parameter:  1.009587
Number of Iterations:  1

Working Correlation
      [,1] [,2] [,3] [,4] [,5] [,6] [,7] [,8] [,9] [,10] [,11] [,12] [,13]
 [1,]    1    0    0    0    0    0    0    0    0     0     0     0     0
 [2,]    0    1    0    0    0    0    0    0    0     0     0     0     0
 [3,]    0    0    1    0    0    0    0    0    0     0     0     0     0
 [4,]    0    0    0    1    0    0    0    0    0     0     0     0     0
 [5,]    0    0    0    0    1    0    0    0    0     0     0     0     0
 [6,]    0    0    0    0    0    1    0    0    0     0     0     0     0
 [7,]    0    0    0    0    0    0    1    0    0     0     0     0     0
 [8,]    0    0    0    0    0    0    0    1    0     0     0     0     0
 [9,]    0    0    0    0    0    0    0    0    1     0     0     0     0
[10,]    0    0    0    0    0    0    0    0    0     1     0     0     0
[11,]    0    0    0    0    0    0    0    0    0     0     1     0     0
[12,]    0    0    0    0    0    0    0    0    0     0     0     1     0
[13,]    0    0    0    0    0    0    0    0    0     0     0     0     1
[14,]    0    0    0    0    0    0    0    0    0     0     0     0     0
[15,]    0    0    0    0    0    0    0    0    0     0     0     0     0
[16,]    0    0    0    0    0    0    0    0    0     0     0     0     0
[17,]    0    0    0    0    0    0    0    0    0     0     0     0     0
[18,]    0    0    0    0    0    0    0    0    0     0     0     0     0
[19,]    0    0    0    0    0    0    0    0    0     0     0     0     0
[20,]    0    0    0    0    0    0    0    0    0     0     0     0     0
      [,14] [,15] [,16] [,17] [,18] [,19] [,20]
 [1,]     0     0     0     0     0     0     0
 [2,]     0     0     0     0     0     0     0
 [3,]     0     0     0     0     0     0     0
 [4,]     0     0     0     0     0     0     0
 [5,]     0     0     0     0     0     0     0
 [6,]     0     0     0     0     0     0     0
 [7,]     0     0     0     0     0     0     0
 [8,]     0     0     0     0     0     0     0
 [9,]     0     0     0     0     0     0     0
[10,]     0     0     0     0     0     0     0
[11,]     0     0     0     0     0     0     0
[12,]     0     0     0     0     0     0     0
[13,]     0     0     0     0     0     0     0
[14,]     1     0     0     0     0     0     0
[15,]     0     1     0     0     0     0     0
[16,]     0     0     1     0     0     0     0
[17,]     0     0     0     1     0     0     0
[18,]     0     0     0     0     1     0     0
[19,]     0     0     0     0     0     1     0
[20,]     0     0     0     0     0     0     1
> glm(lgind~x2+x3+x4,data=testgee, start=rep(0,4), # needed in R
+     family=quasi(link=logit,variance="mu(1-mu)"))

Call:  glm(formula = lgind ~ x2 + x3 + x4, family = quasi(link = logit,      variance = "mu(1-mu)"), data = testgee, start = rep(0, 4)) 

Coefficients:
(Intercept)           x2           x3           x4  
    4.72921     -0.34748     -0.21940     -0.07104  

Degrees of Freedom: 499 Total (i.e. Null);  496 Residual
Null Deviance:	    635.6 
Residual Deviance: 591.4 	AIC: NA 
> 
> summary(gee(lgind~x2+x3+x4,id=id,data=testgee,family=binomial,scale.fix=TRUE))
Beginning Cgee S-function, @(#) geeformula.q 4.13 98/01/27
running glm to get initial regression estimate
(Intercept)          x2          x3          x4 
 4.72920874 -0.34747871 -0.21939993 -0.07103635 

 GEE:  GENERALIZED LINEAR MODELS FOR DEPENDENT DATA
 gee S-function, version 4.13 modified 98/01/27 (1998) 

Model:
 Link:                      Logit 
 Variance to Mean Relation: Binomial 
 Correlation Structure:     Independent 

Call:
gee(formula = lgind ~ x2 + x3 + x4, id = id, data = testgee, 
    family = binomial, scale.fix = TRUE)

Summary of Residuals:
       Min         1Q     Median         3Q        Max 
-0.7537945 -0.3323381 -0.2080574  0.5160616  0.8872020 


Coefficients:
               Estimate Naive S.E.   Naive z Robust S.E.  Robust z
(Intercept)  4.72920874 1.02718977  4.604026  0.86323313  5.478484
x2          -0.34747871 0.06271394 -5.540693  0.05004796 -6.942915
x3          -0.21939993 0.07914189 -2.772235  0.07725222 -2.840047
x4          -0.07103635 0.04132290 -1.719055  0.03167549 -2.242628

Estimated Scale Parameter:  1
Number of Iterations:  1

Working Correlation
      [,1] [,2] [,3] [,4] [,5] [,6] [,7] [,8] [,9] [,10] [,11] [,12] [,13]
 [1,]    1    0    0    0    0    0    0    0    0     0     0     0     0
 [2,]    0    1    0    0    0    0    0    0    0     0     0     0     0
 [3,]    0    0    1    0    0    0    0    0    0     0     0     0     0
 [4,]    0    0    0    1    0    0    0    0    0     0     0     0     0
 [5,]    0    0    0    0    1    0    0    0    0     0     0     0     0
 [6,]    0    0    0    0    0    1    0    0    0     0     0     0     0
 [7,]    0    0    0    0    0    0    1    0    0     0     0     0     0
 [8,]    0    0    0    0    0    0    0    1    0     0     0     0     0
 [9,]    0    0    0    0    0    0    0    0    1     0     0     0     0
[10,]    0    0    0    0    0    0    0    0    0     1     0     0     0
[11,]    0    0    0    0    0    0    0    0    0     0     1     0     0
[12,]    0    0    0    0    0    0    0    0    0     0     0     1     0
[13,]    0    0    0    0    0    0    0    0    0     0     0     0     1
[14,]    0    0    0    0    0    0    0    0    0     0     0     0     0
[15,]    0    0    0    0    0    0    0    0    0     0     0     0     0
[16,]    0    0    0    0    0    0    0    0    0     0     0     0     0
[17,]    0    0    0    0    0    0    0    0    0     0     0     0     0
[18,]    0    0    0    0    0    0    0    0    0     0     0     0     0
[19,]    0    0    0    0    0    0    0    0    0     0     0     0     0
[20,]    0    0    0    0    0    0    0    0    0     0     0     0     0
      [,14] [,15] [,16] [,17] [,18] [,19] [,20]
 [1,]     0     0     0     0     0     0     0
 [2,]     0     0     0     0     0     0     0
 [3,]     0     0     0     0     0     0     0
 [4,]     0     0     0     0     0     0     0
 [5,]     0     0     0     0     0     0     0
 [6,]     0     0     0     0     0     0     0
 [7,]     0     0     0     0     0     0     0
 [8,]     0     0     0     0     0     0     0
 [9,]     0     0     0     0     0     0     0
[10,]     0     0     0     0     0     0     0
[11,]     0     0     0     0     0     0     0
[12,]     0     0     0     0     0     0     0
[13,]     0     0     0     0     0     0     0
[14,]     1     0     0     0     0     0     0
[15,]     0     1     0     0     0     0     0
[16,]     0     0     1     0     0     0     0
[17,]     0     0     0     1     0     0     0
[18,]     0     0     0     0     1     0     0
[19,]     0     0     0     0     0     1     0
[20,]     0     0     0     0     0     0     1
> #glm(lgind~x2+x3+x4,data=testgee,family=binomial)
> 
> summary(gee(lg~x2+x3+x4,id=id,data=testgee,family=binomial,corstr="exchangeable"))
Beginning Cgee S-function, @(#) geeformula.q 4.13 98/01/27
running glm to get initial regression estimate
(Intercept)          x2          x3          x4 
  6.4719531  -0.2719330  -0.2759630  -0.1493855 

 GEE:  GENERALIZED LINEAR MODELS FOR DEPENDENT DATA
 gee S-function, version 4.13 modified 98/01/27 (1998) 

Model:
 Link:                      Logit 
 Variance to Mean Relation: Binomial 
 Correlation Structure:     Exchangeable 

Call:
gee(formula = lg ~ x2 + x3 + x4, id = id, data = testgee, family = binomial, 
    corstr = "exchangeable")

Summary of Residuals:
       Min         1Q     Median         3Q        Max 
-0.9132133 -0.4779069  0.2183723  0.4022373  0.8322064 


Coefficients:
              Estimate Naive S.E.   Naive z Robust S.E.  Robust z
(Intercept)  6.3714080 1.01872823  6.254276  0.82259807  7.745469
x2          -0.2582285 0.05832328 -4.427537  0.06432493 -4.014439
x3          -0.2792487 0.07639349 -3.655399  0.05877904 -4.750820
x4          -0.1458317 0.04000757 -3.645104  0.02732683 -5.336576

Estimated Scale Parameter:  1.008096
Number of Iterations:  3

Working Correlation
             [,1]        [,2]        [,3]        [,4]        [,5]        [,6]
 [1,]  1.00000000 -0.02048602 -0.02048602 -0.02048602 -0.02048602 -0.02048602
 [2,] -0.02048602  1.00000000 -0.02048602 -0.02048602 -0.02048602 -0.02048602
 [3,] -0.02048602 -0.02048602  1.00000000 -0.02048602 -0.02048602 -0.02048602
 [4,] -0.02048602 -0.02048602 -0.02048602  1.00000000 -0.02048602 -0.02048602
 [5,] -0.02048602 -0.02048602 -0.02048602 -0.02048602  1.00000000 -0.02048602
 [6,] -0.02048602 -0.02048602 -0.02048602 -0.02048602 -0.02048602  1.00000000
 [7,] -0.02048602 -0.02048602 -0.02048602 -0.02048602 -0.02048602 -0.02048602
 [8,] -0.02048602 -0.02048602 -0.02048602 -0.02048602 -0.02048602 -0.02048602
 [9,] -0.02048602 -0.02048602 -0.02048602 -0.02048602 -0.02048602 -0.02048602
[10,] -0.02048602 -0.02048602 -0.02048602 -0.02048602 -0.02048602 -0.02048602
[11,] -0.02048602 -0.02048602 -0.02048602 -0.02048602 -0.02048602 -0.02048602
[12,] -0.02048602 -0.02048602 -0.02048602 -0.02048602 -0.02048602 -0.02048602
[13,] -0.02048602 -0.02048602 -0.02048602 -0.02048602 -0.02048602 -0.02048602
[14,] -0.02048602 -0.02048602 -0.02048602 -0.02048602 -0.02048602 -0.02048602
[15,] -0.02048602 -0.02048602 -0.02048602 -0.02048602 -0.02048602 -0.02048602
[16,] -0.02048602 -0.02048602 -0.02048602 -0.02048602 -0.02048602 -0.02048602
[17,] -0.02048602 -0.02048602 -0.02048602 -0.02048602 -0.02048602 -0.02048602
[18,] -0.02048602 -0.02048602 -0.02048602 -0.02048602 -0.02048602 -0.02048602
[19,] -0.02048602 -0.02048602 -0.02048602 -0.02048602 -0.02048602 -0.02048602
[20,] -0.02048602 -0.02048602 -0.02048602 -0.02048602 -0.02048602 -0.02048602
             [,7]        [,8]        [,9]       [,10]       [,11]       [,12]
 [1,] -0.02048602 -0.02048602 -0.02048602 -0.02048602 -0.02048602 -0.02048602
 [2,] -0.02048602 -0.02048602 -0.02048602 -0.02048602 -0.02048602 -0.02048602
 [3,] -0.02048602 -0.02048602 -0.02048602 -0.02048602 -0.02048602 -0.02048602
 [4,] -0.02048602 -0.02048602 -0.02048602 -0.02048602 -0.02048602 -0.02048602
 [5,] -0.02048602 -0.02048602 -0.02048602 -0.02048602 -0.02048602 -0.02048602
 [6,] -0.02048602 -0.02048602 -0.02048602 -0.02048602 -0.02048602 -0.02048602
 [7,]  1.00000000 -0.02048602 -0.02048602 -0.02048602 -0.02048602 -0.02048602
 [8,] -0.02048602  1.00000000 -0.02048602 -0.02048602 -0.02048602 -0.02048602
 [9,] -0.02048602 -0.02048602  1.00000000 -0.02048602 -0.02048602 -0.02048602
[10,] -0.02048602 -0.02048602 -0.02048602  1.00000000 -0.02048602 -0.02048602
[11,] -0.02048602 -0.02048602 -0.02048602 -0.02048602  1.00000000 -0.02048602
[12,] -0.02048602 -0.02048602 -0.02048602 -0.02048602 -0.02048602  1.00000000
[13,] -0.02048602 -0.02048602 -0.02048602 -0.02048602 -0.02048602 -0.02048602
[14,] -0.02048602 -0.02048602 -0.02048602 -0.02048602 -0.02048602 -0.02048602
[15,] -0.02048602 -0.02048602 -0.02048602 -0.02048602 -0.02048602 -0.02048602
[16,] -0.02048602 -0.02048602 -0.02048602 -0.02048602 -0.02048602 -0.02048602
[17,] -0.02048602 -0.02048602 -0.02048602 -0.02048602 -0.02048602 -0.02048602
[18,] -0.02048602 -0.02048602 -0.02048602 -0.02048602 -0.02048602 -0.02048602
[19,] -0.02048602 -0.02048602 -0.02048602 -0.02048602 -0.02048602 -0.02048602
[20,] -0.02048602 -0.02048602 -0.02048602 -0.02048602 -0.02048602 -0.02048602
            [,13]       [,14]       [,15]       [,16]       [,17]       [,18]
 [1,] -0.02048602 -0.02048602 -0.02048602 -0.02048602 -0.02048602 -0.02048602
 [2,] -0.02048602 -0.02048602 -0.02048602 -0.02048602 -0.02048602 -0.02048602
 [3,] -0.02048602 -0.02048602 -0.02048602 -0.02048602 -0.02048602 -0.02048602
 [4,] -0.02048602 -0.02048602 -0.02048602 -0.02048602 -0.02048602 -0.02048602
 [5,] -0.02048602 -0.02048602 -0.02048602 -0.02048602 -0.02048602 -0.02048602
 [6,] -0.02048602 -0.02048602 -0.02048602 -0.02048602 -0.02048602 -0.02048602
 [7,] -0.02048602 -0.02048602 -0.02048602 -0.02048602 -0.02048602 -0.02048602
 [8,] -0.02048602 -0.02048602 -0.02048602 -0.02048602 -0.02048602 -0.02048602
 [9,] -0.02048602 -0.02048602 -0.02048602 -0.02048602 -0.02048602 -0.02048602
[10,] -0.02048602 -0.02048602 -0.02048602 -0.02048602 -0.02048602 -0.02048602
[11,] -0.02048602 -0.02048602 -0.02048602 -0.02048602 -0.02048602 -0.02048602
[12,] -0.02048602 -0.02048602 -0.02048602 -0.02048602 -0.02048602 -0.02048602
[13,]  1.00000000 -0.02048602 -0.02048602 -0.02048602 -0.02048602 -0.02048602
[14,] -0.02048602  1.00000000 -0.02048602 -0.02048602 -0.02048602 -0.02048602
[15,] -0.02048602 -0.02048602  1.00000000 -0.02048602 -0.02048602 -0.02048602
[16,] -0.02048602 -0.02048602 -0.02048602  1.00000000 -0.02048602 -0.02048602
[17,] -0.02048602 -0.02048602 -0.02048602 -0.02048602  1.00000000 -0.02048602
[18,] -0.02048602 -0.02048602 -0.02048602 -0.02048602 -0.02048602  1.00000000
[19,] -0.02048602 -0.02048602 -0.02048602 -0.02048602 -0.02048602 -0.02048602
[20,] -0.02048602 -0.02048602 -0.02048602 -0.02048602 -0.02048602 -0.02048602
            [,19]       [,20]
 [1,] -0.02048602 -0.02048602
 [2,] -0.02048602 -0.02048602
 [3,] -0.02048602 -0.02048602
 [4,] -0.02048602 -0.02048602
 [5,] -0.02048602 -0.02048602
 [6,] -0.02048602 -0.02048602
 [7,] -0.02048602 -0.02048602
 [8,] -0.02048602 -0.02048602
 [9,] -0.02048602 -0.02048602
[10,] -0.02048602 -0.02048602
[11,] -0.02048602 -0.02048602
[12,] -0.02048602 -0.02048602
[13,] -0.02048602 -0.02048602
[14,] -0.02048602 -0.02048602
[15,] -0.02048602 -0.02048602
[16,] -0.02048602 -0.02048602
[17,] -0.02048602 -0.02048602
[18,] -0.02048602 -0.02048602
[19,]  1.00000000 -0.02048602
[20,] -0.02048602  1.00000000
> summary(gee(lg~x2+x3+x4,id=id,data=testgee,family=binomial,corstr="stat_M_dep",M=1))
Beginning Cgee S-function, @(#) geeformula.q 4.13 98/01/27
running glm to get initial regression estimate
(Intercept)          x2          x3          x4 
  6.4719531  -0.2719330  -0.2759630  -0.1493855 

 GEE:  GENERALIZED LINEAR MODELS FOR DEPENDENT DATA
 gee S-function, version 4.13 modified 98/01/27 (1998) 

Model:
 Link:                      Logit 
 Variance to Mean Relation: Binomial 
 Correlation Structure:     Stationary M-dependent , M = 1 

Call:
gee(formula = lg ~ x2 + x3 + x4, id = id, data = testgee, family = binomial, 
    corstr = "stat_M_dep", Mv = 1)

Summary of Residuals:
       Min         1Q     Median         3Q        Max 
-0.8834271 -0.4920962  0.2491360  0.4108783  0.7887767 


Coefficients:
              Estimate Naive S.E.   Naive z Robust S.E.  Robust z
(Intercept)  5.4093789 0.84036337  6.436952  0.70900809  7.629502
x2          -0.2069859 0.04869638 -4.250540  0.05089218 -4.067147
x3          -0.2469902 0.06394554 -3.862508  0.04953133 -4.986545
x4          -0.1193671 0.03385364 -3.525976  0.02800656 -4.262113

Estimated Scale Parameter:  0.9787236
Number of Iterations:  3

Working Correlation
            [,1]       [,2]       [,3]       [,4]       [,5]       [,6]
 [1,]  1.0000000 -0.3301082  0.0000000  0.0000000  0.0000000  0.0000000
 [2,] -0.3301082  1.0000000 -0.3301082  0.0000000  0.0000000  0.0000000
 [3,]  0.0000000 -0.3301082  1.0000000 -0.3301082  0.0000000  0.0000000
 [4,]  0.0000000  0.0000000 -0.3301082  1.0000000 -0.3301082  0.0000000
 [5,]  0.0000000  0.0000000  0.0000000 -0.3301082  1.0000000 -0.3301082
 [6,]  0.0000000  0.0000000  0.0000000  0.0000000 -0.3301082  1.0000000
 [7,]  0.0000000  0.0000000  0.0000000  0.0000000  0.0000000 -0.3301082
 [8,]  0.0000000  0.0000000  0.0000000  0.0000000  0.0000000  0.0000000
 [9,]  0.0000000  0.0000000  0.0000000  0.0000000  0.0000000  0.0000000
[10,]  0.0000000  0.0000000  0.0000000  0.0000000  0.0000000  0.0000000
[11,]  0.0000000  0.0000000  0.0000000  0.0000000  0.0000000  0.0000000
[12,]  0.0000000  0.0000000  0.0000000  0.0000000  0.0000000  0.0000000
[13,]  0.0000000  0.0000000  0.0000000  0.0000000  0.0000000  0.0000000
[14,]  0.0000000  0.0000000  0.0000000  0.0000000  0.0000000  0.0000000
[15,]  0.0000000  0.0000000  0.0000000  0.0000000  0.0000000  0.0000000
[16,]  0.0000000  0.0000000  0.0000000  0.0000000  0.0000000  0.0000000
[17,]  0.0000000  0.0000000  0.0000000  0.0000000  0.0000000  0.0000000
[18,]  0.0000000  0.0000000  0.0000000  0.0000000  0.0000000  0.0000000
[19,]  0.0000000  0.0000000  0.0000000  0.0000000  0.0000000  0.0000000
[20,]  0.0000000  0.0000000  0.0000000  0.0000000  0.0000000  0.0000000
            [,7]       [,8]       [,9]      [,10]      [,11]      [,12]
 [1,]  0.0000000  0.0000000  0.0000000  0.0000000  0.0000000  0.0000000
 [2,]  0.0000000  0.0000000  0.0000000  0.0000000  0.0000000  0.0000000
 [3,]  0.0000000  0.0000000  0.0000000  0.0000000  0.0000000  0.0000000
 [4,]  0.0000000  0.0000000  0.0000000  0.0000000  0.0000000  0.0000000
 [5,]  0.0000000  0.0000000  0.0000000  0.0000000  0.0000000  0.0000000
 [6,] -0.3301082  0.0000000  0.0000000  0.0000000  0.0000000  0.0000000
 [7,]  1.0000000 -0.3301082  0.0000000  0.0000000  0.0000000  0.0000000
 [8,] -0.3301082  1.0000000 -0.3301082  0.0000000  0.0000000  0.0000000
 [9,]  0.0000000 -0.3301082  1.0000000 -0.3301082  0.0000000  0.0000000
[10,]  0.0000000  0.0000000 -0.3301082  1.0000000 -0.3301082  0.0000000
[11,]  0.0000000  0.0000000  0.0000000 -0.3301082  1.0000000 -0.3301082
[12,]  0.0000000  0.0000000  0.0000000  0.0000000 -0.3301082  1.0000000
[13,]  0.0000000  0.0000000  0.0000000  0.0000000  0.0000000 -0.3301082
[14,]  0.0000000  0.0000000  0.0000000  0.0000000  0.0000000  0.0000000
[15,]  0.0000000  0.0000000  0.0000000  0.0000000  0.0000000  0.0000000
[16,]  0.0000000  0.0000000  0.0000000  0.0000000  0.0000000  0.0000000
[17,]  0.0000000  0.0000000  0.0000000  0.0000000  0.0000000  0.0000000
[18,]  0.0000000  0.0000000  0.0000000  0.0000000  0.0000000  0.0000000
[19,]  0.0000000  0.0000000  0.0000000  0.0000000  0.0000000  0.0000000
[20,]  0.0000000  0.0000000  0.0000000  0.0000000  0.0000000  0.0000000
           [,13]      [,14]      [,15]      [,16]      [,17]      [,18]
 [1,]  0.0000000  0.0000000  0.0000000  0.0000000  0.0000000  0.0000000
 [2,]  0.0000000  0.0000000  0.0000000  0.0000000  0.0000000  0.0000000
 [3,]  0.0000000  0.0000000  0.0000000  0.0000000  0.0000000  0.0000000
 [4,]  0.0000000  0.0000000  0.0000000  0.0000000  0.0000000  0.0000000
 [5,]  0.0000000  0.0000000  0.0000000  0.0000000  0.0000000  0.0000000
 [6,]  0.0000000  0.0000000  0.0000000  0.0000000  0.0000000  0.0000000
 [7,]  0.0000000  0.0000000  0.0000000  0.0000000  0.0000000  0.0000000
 [8,]  0.0000000  0.0000000  0.0000000  0.0000000  0.0000000  0.0000000
 [9,]  0.0000000  0.0000000  0.0000000  0.0000000  0.0000000  0.0000000
[10,]  0.0000000  0.0000000  0.0000000  0.0000000  0.0000000  0.0000000
[11,]  0.0000000  0.0000000  0.0000000  0.0000000  0.0000000  0.0000000
[12,] -0.3301082  0.0000000  0.0000000  0.0000000  0.0000000  0.0000000
[13,]  1.0000000 -0.3301082  0.0000000  0.0000000  0.0000000  0.0000000
[14,] -0.3301082  1.0000000 -0.3301082  0.0000000  0.0000000  0.0000000
[15,]  0.0000000 -0.3301082  1.0000000 -0.3301082  0.0000000  0.0000000
[16,]  0.0000000  0.0000000 -0.3301082  1.0000000 -0.3301082  0.0000000
[17,]  0.0000000  0.0000000  0.0000000 -0.3301082  1.0000000 -0.3301082
[18,]  0.0000000  0.0000000  0.0000000  0.0000000 -0.3301082  1.0000000
[19,]  0.0000000  0.0000000  0.0000000  0.0000000  0.0000000 -0.3301082
[20,]  0.0000000  0.0000000  0.0000000  0.0000000  0.0000000  0.0000000
           [,19]      [,20]
 [1,]  0.0000000  0.0000000
 [2,]  0.0000000  0.0000000
 [3,]  0.0000000  0.0000000
 [4,]  0.0000000  0.0000000
 [5,]  0.0000000  0.0000000
 [6,]  0.0000000  0.0000000
 [7,]  0.0000000  0.0000000
 [8,]  0.0000000  0.0000000
 [9,]  0.0000000  0.0000000
[10,]  0.0000000  0.0000000
[11,]  0.0000000  0.0000000
[12,]  0.0000000  0.0000000
[13,]  0.0000000  0.0000000
[14,]  0.0000000  0.0000000
[15,]  0.0000000  0.0000000
[16,]  0.0000000  0.0000000
[17,]  0.0000000  0.0000000
[18,] -0.3301082  0.0000000
[19,]  1.0000000 -0.3301082
[20,] -0.3301082  1.0000000
> 
> summary(gee(lg~x2+x3+x4,id=id,data=testgee,family=binomial(link=probit)))
Beginning Cgee S-function, @(#) geeformula.q 4.13 98/01/27
running glm to get initial regression estimate
(Intercept)          x2          x3          x4 
 3.92612377 -0.16597664 -0.16503829 -0.09214249 

 GEE:  GENERALIZED LINEAR MODELS FOR DEPENDENT DATA
 gee S-function, version 4.13 modified 98/01/27 (1998) 

Model:
 Link:                      Probit 
 Variance to Mean Relation: Binomial 
 Correlation Structure:     Independent 

Call:
gee(formula = lg ~ x2 + x3 + x4, id = id, data = testgee, family = binomial(link = probit))

Summary of Residuals:
       Min         1Q     Median         3Q        Max 
-0.9259107 -0.4767799  0.2158545  0.4033760  0.8384385 


Coefficients:
               Estimate Naive S.E.   Naive z Robust S.E.  Robust z
(Intercept)  3.92613715 0.61214299  6.413758  0.53755155  7.303741
x2          -0.16597696 0.03582656 -4.632790  0.04006791 -4.142391
x3          -0.16503933 0.04665763 -3.537242  0.03848563 -4.288336
x4          -0.09214252 0.02457762 -3.749042  0.01654858 -5.568001

Estimated Scale Parameter:  1.014784
Number of Iterations:  1

Working Correlation
      [,1] [,2] [,3] [,4] [,5] [,6] [,7] [,8] [,9] [,10] [,11] [,12] [,13]
 [1,]    1    0    0    0    0    0    0    0    0     0     0     0     0
 [2,]    0    1    0    0    0    0    0    0    0     0     0     0     0
 [3,]    0    0    1    0    0    0    0    0    0     0     0     0     0
 [4,]    0    0    0    1    0    0    0    0    0     0     0     0     0
 [5,]    0    0    0    0    1    0    0    0    0     0     0     0     0
 [6,]    0    0    0    0    0    1    0    0    0     0     0     0     0
 [7,]    0    0    0    0    0    0    1    0    0     0     0     0     0
 [8,]    0    0    0    0    0    0    0    1    0     0     0     0     0
 [9,]    0    0    0    0    0    0    0    0    1     0     0     0     0
[10,]    0    0    0    0    0    0    0    0    0     1     0     0     0
[11,]    0    0    0    0    0    0    0    0    0     0     1     0     0
[12,]    0    0    0    0    0    0    0    0    0     0     0     1     0
[13,]    0    0    0    0    0    0    0    0    0     0     0     0     1
[14,]    0    0    0    0    0    0    0    0    0     0     0     0     0
[15,]    0    0    0    0    0    0    0    0    0     0     0     0     0
[16,]    0    0    0    0    0    0    0    0    0     0     0     0     0
[17,]    0    0    0    0    0    0    0    0    0     0     0     0     0
[18,]    0    0    0    0    0    0    0    0    0     0     0     0     0
[19,]    0    0    0    0    0    0    0    0    0     0     0     0     0
[20,]    0    0    0    0    0    0    0    0    0     0     0     0     0
      [,14] [,15] [,16] [,17] [,18] [,19] [,20]
 [1,]     0     0     0     0     0     0     0
 [2,]     0     0     0     0     0     0     0
 [3,]     0     0     0     0     0     0     0
 [4,]     0     0     0     0     0     0     0
 [5,]     0     0     0     0     0     0     0
 [6,]     0     0     0     0     0     0     0
 [7,]     0     0     0     0     0     0     0
 [8,]     0     0     0     0     0     0     0
 [9,]     0     0     0     0     0     0     0
[10,]     0     0     0     0     0     0     0
[11,]     0     0     0     0     0     0     0
[12,]     0     0     0     0     0     0     0
[13,]     0     0     0     0     0     0     0
[14,]     1     0     0     0     0     0     0
[15,]     0     1     0     0     0     0     0
[16,]     0     0     1     0     0     0     0
[17,]     0     0     0     1     0     0     0
[18,]     0     0     0     0     1     0     0
[19,]     0     0     0     0     0     1     0
[20,]     0     0     0     0     0     0     1
> # next line does not work in R's glm: needs starting values for quasi
> #summary(gee(lg~x2+x3+x4,id=id,data=testgee,family=quasi(link=probit,variance="mu(1-mu)")))
> summary(gee(lg~x2+x3+x4, id=id, data=testgee, b=rep(0,4), family=quasi(link=probit,variance="mu(1-mu)")))
Beginning Cgee S-function, @(#) geeformula.q 4.13 98/01/27
user's initial regression estimate
     [,1]
[1,]    0
[2,]    0
[3,]    0
[4,]    0

 GEE:  GENERALIZED LINEAR MODELS FOR DEPENDENT DATA
 gee S-function, version 4.13 modified 98/01/27 (1998) 

Model:
 Link:                      Probit 
 Variance to Mean Relation: Binomial 
 Correlation Structure:     Independent 

Call:
gee(formula = lg ~ x2 + x3 + x4, id = id, data = testgee, b = rep(0, 
    4), family = quasi(link = probit, variance = "mu(1-mu)"))

Summary of Residuals:
       Min         1Q     Median         3Q        Max 
-0.9259108 -0.4767799  0.2158545  0.4033761  0.8384386 


Coefficients:
               Estimate Naive S.E.   Naive z Robust S.E.  Robust z
(Intercept)  3.92613840 0.61214303  6.413760  0.53755167  7.303741
x2          -0.16597699 0.03582656 -4.632791  0.04006791 -4.142392
x3          -0.16503949 0.04665763 -3.537245  0.03848564 -4.288340
x4          -0.09214246 0.02457762 -3.749040  0.01654858 -5.567998

Estimated Scale Parameter:  1.014784
Number of Iterations:  4

Working Correlation
      [,1] [,2] [,3] [,4] [,5] [,6] [,7] [,8] [,9] [,10] [,11] [,12] [,13]
 [1,]    1    0    0    0    0    0    0    0    0     0     0     0     0
 [2,]    0    1    0    0    0    0    0    0    0     0     0     0     0
 [3,]    0    0    1    0    0    0    0    0    0     0     0     0     0
 [4,]    0    0    0    1    0    0    0    0    0     0     0     0     0
 [5,]    0    0    0    0    1    0    0    0    0     0     0     0     0
 [6,]    0    0    0    0    0    1    0    0    0     0     0     0     0
 [7,]    0    0    0    0    0    0    1    0    0     0     0     0     0
 [8,]    0    0    0    0    0    0    0    1    0     0     0     0     0
 [9,]    0    0    0    0    0    0    0    0    1     0     0     0     0
[10,]    0    0    0    0    0    0    0    0    0     1     0     0     0
[11,]    0    0    0    0    0    0    0    0    0     0     1     0     0
[12,]    0    0    0    0    0    0    0    0    0     0     0     1     0
[13,]    0    0    0    0    0    0    0    0    0     0     0     0     1
[14,]    0    0    0    0    0    0    0    0    0     0     0     0     0
[15,]    0    0    0    0    0    0    0    0    0     0     0     0     0
[16,]    0    0    0    0    0    0    0    0    0     0     0     0     0
[17,]    0    0    0    0    0    0    0    0    0     0     0     0     0
[18,]    0    0    0    0    0    0    0    0    0     0     0     0     0
[19,]    0    0    0    0    0    0    0    0    0     0     0     0     0
[20,]    0    0    0    0    0    0    0    0    0     0     0     0     0
      [,14] [,15] [,16] [,17] [,18] [,19] [,20]
 [1,]     0     0     0     0     0     0     0
 [2,]     0     0     0     0     0     0     0
 [3,]     0     0     0     0     0     0     0
 [4,]     0     0     0     0     0     0     0
 [5,]     0     0     0     0     0     0     0
 [6,]     0     0     0     0     0     0     0
 [7,]     0     0     0     0     0     0     0
 [8,]     0     0     0     0     0     0     0
 [9,]     0     0     0     0     0     0     0
[10,]     0     0     0     0     0     0     0
[11,]     0     0     0     0     0     0     0
[12,]     0     0     0     0     0     0     0
[13,]     0     0     0     0     0     0     0
[14,]     1     0     0     0     0     0     0
[15,]     0     1     0     0     0     0     0
[16,]     0     0     1     0     0     0     0
[17,]     0     0     0     1     0     0     0
[18,]     0     0     0     0     1     0     0
[19,]     0     0     0     0     0     1     0
[20,]     0     0     0     0     0     0     1
> 
> logmat <- cbind(testgee[,"lg1"],testgee[,"nn"])
> xmat   <- cbind(testgee[,"x2"], testgee[,"x3"])
> summary(gee(logmat~xmat,id = testgee[,"id"],family=binomial(link=probit)))
Beginning Cgee S-function, @(#) geeformula.q 4.13 98/01/27
running glm to get initial regression estimate
(Intercept)       xmat1       xmat2 
 0.51795625 -0.06406827 -0.04156066 

 GEE:  GENERALIZED LINEAR MODELS FOR DEPENDENT DATA
 gee S-function, version 4.13 modified 98/01/27 (1998) 

Model:
 Link:                      Probit 
 Variance to Mean Relation: Binomial 
 Correlation Structure:     Independent 

Call:
gee(formula = logmat ~ xmat, id = testgee[, "id"], family = binomial(link = probit))

Summary of Residuals:
       Min         1Q     Median         3Q        Max 
 0.5160816  1.7308948  4.6651553  7.6862003 19.5931240 


Coefficients:
               Estimate  Naive S.E.   Naive z Robust S.E.  Robust z
(Intercept)  0.51795627 0.102935017  5.031876 0.104967578  4.934441
xmat1       -0.06406827 0.006534226 -9.805029 0.006443532 -9.943037
xmat2       -0.04156066 0.008875153 -4.682810 0.010589196 -3.924817

Estimated Scale Parameter:  0.6334804
Number of Iterations:  1

Working Correlation
      [,1] [,2] [,3] [,4] [,5] [,6] [,7] [,8] [,9] [,10] [,11] [,12] [,13]
 [1,]    1    0    0    0    0    0    0    0    0     0     0     0     0
 [2,]    0    1    0    0    0    0    0    0    0     0     0     0     0
 [3,]    0    0    1    0    0    0    0    0    0     0     0     0     0
 [4,]    0    0    0    1    0    0    0    0    0     0     0     0     0
 [5,]    0    0    0    0    1    0    0    0    0     0     0     0     0
 [6,]    0    0    0    0    0    1    0    0    0     0     0     0     0
 [7,]    0    0    0    0    0    0    1    0    0     0     0     0     0
 [8,]    0    0    0    0    0    0    0    1    0     0     0     0     0
 [9,]    0    0    0    0    0    0    0    0    1     0     0     0     0
[10,]    0    0    0    0    0    0    0    0    0     1     0     0     0
[11,]    0    0    0    0    0    0    0    0    0     0     1     0     0
[12,]    0    0    0    0    0    0    0    0    0     0     0     1     0
[13,]    0    0    0    0    0    0    0    0    0     0     0     0     1
[14,]    0    0    0    0    0    0    0    0    0     0     0     0     0
[15,]    0    0    0    0    0    0    0    0    0     0     0     0     0
[16,]    0    0    0    0    0    0    0    0    0     0     0     0     0
[17,]    0    0    0    0    0    0    0    0    0     0     0     0     0
[18,]    0    0    0    0    0    0    0    0    0     0     0     0     0
[19,]    0    0    0    0    0    0    0    0    0     0     0     0     0
[20,]    0    0    0    0    0    0    0    0    0     0     0     0     0
      [,14] [,15] [,16] [,17] [,18] [,19] [,20]
 [1,]     0     0     0     0     0     0     0
 [2,]     0     0     0     0     0     0     0
 [3,]     0     0     0     0     0     0     0
 [4,]     0     0     0     0     0     0     0
 [5,]     0     0     0     0     0     0     0
 [6,]     0     0     0     0     0     0     0
 [7,]     0     0     0     0     0     0     0
 [8,]     0     0     0     0     0     0     0
 [9,]     0     0     0     0     0     0     0
[10,]     0     0     0     0     0     0     0
[11,]     0     0     0     0     0     0     0
[12,]     0     0     0     0     0     0     0
[13,]     0     0     0     0     0     0     0
[14,]     1     0     0     0     0     0     0
[15,]     0     1     0     0     0     0     0
[16,]     0     0     1     0     0     0     0
[17,]     0     0     0     1     0     0     0
[18,]     0     0     0     0     1     0     0
[19,]     0     0     0     0     0     1     0
[20,]     0     0     0     0     0     0     1
> 
> sub<-rep(c(FALSE,FALSE,FALSE,FALSE,TRUE),100)
> summary(gee(lg~x2+x4,id=id,data=testgee,family=binomial,subset=sub))
Beginning Cgee S-function, @(#) geeformula.q 4.13 98/01/27
running glm to get initial regression estimate
(Intercept)          x2          x4 
  5.5224757  -0.3467620  -0.2667172 

 GEE:  GENERALIZED LINEAR MODELS FOR DEPENDENT DATA
 gee S-function, version 4.13 modified 98/01/27 (1998) 

Model:
 Link:                      Logit 
 Variance to Mean Relation: Binomial 
 Correlation Structure:     Independent 

Call:
gee(formula = lg ~ x2 + x4, id = id, data = testgee, subset = sub, 
    family = binomial)

Summary of Residuals:
       Min         1Q     Median         3Q        Max 
-0.8367702 -0.5120235  0.1897604  0.3569406  0.7244263 


Coefficients:
              Estimate Naive S.E.   Naive z Robust S.E.  Robust z
(Intercept)  5.5224757  1.5820384  3.490734  1.25770291  4.390922
x2          -0.3467620  0.1323609 -2.619823  0.12032183 -2.881954
x4          -0.2667172  0.1190969 -2.239497  0.08655567 -3.081453

Estimated Scale Parameter:  0.9974213
Number of Iterations:  1

Working Correlation
     [,1] [,2] [,3] [,4]
[1,]    1    0    0    0
[2,]    0    1    0    0
[3,]    0    0    1    0
[4,]    0    0    0    1
> 
> R <- c(1.0,0.2,0.3,0.1,
+        0.2,1.0,0.2,0.3,
+        0.3,0.2,1.0,0.2,
+        0.1,0.3,0.2,1.0)
> R <- matrix(R,nrow=4)
> summary(gee(lg1~x2+x4,id=id,data=testgee,family=poisson(link=log),
+              subset=sub,corstr="fixed",R=R))
Beginning Cgee S-function, @(#) geeformula.q 4.13 98/01/27
running glm to get initial regression estimate
(Intercept)          x2          x4 
 2.80530150 -0.08997444 -0.04801454 

 GEE:  GENERALIZED LINEAR MODELS FOR DEPENDENT DATA
 gee S-function, version 4.13 modified 98/01/27 (1998) 

Model:
 Link:                      Logarithm 
 Variance to Mean Relation: Poisson 
 Correlation Structure:     Fixed 

Call:
gee(formula = lg1 ~ x2 + x4, id = id, data = testgee, subset = sub, 
    R = R, family = poisson(link = log), corstr = "fixed")

Summary of Residuals:
       Min         1Q     Median         3Q        Max 
-7.5561190 -3.0282712 -0.7601115  2.3823498 12.5360530 


Coefficients:
               Estimate Naive S.E.   Naive z Robust S.E.  Robust z
(Intercept)  3.02620978 0.43234114  6.999588  0.34930120  8.663611
x2          -0.10058734 0.04084446 -2.462692  0.04687746 -2.145751
x4          -0.06504106 0.03683906 -1.765546  0.03434579 -1.893713

Estimated Scale Parameter:  3.192382
Number of Iterations:  3

Working Correlation
     [,1] [,2] [,3] [,4]
[1,]  1.0  0.2  0.3  0.1
[2,]  0.2  1.0  0.2  0.3
[3,]  0.3  0.2  1.0  0.2
[4,]  0.1  0.3  0.2  1.0
> summary(gee(lg1~x2+x4,id=id,data=testgee,family=Gamma(link=log),
+              subset=sub,corstr="fixed",R=R))
Beginning Cgee S-function, @(#) geeformula.q 4.13 98/01/27
running glm to get initial regression estimate
(Intercept)          x2          x4 
 2.87964611 -0.08377511 -0.06186083 

 GEE:  GENERALIZED LINEAR MODELS FOR DEPENDENT DATA
 gee S-function, version 4.13 modified 98/01/27 (1998) 

Model:
 Link:                      Logarithm 
 Variance to Mean Relation: Gamma 
 Correlation Structure:     Fixed 

Call:
gee(formula = lg1 ~ x2 + x4, id = id, data = testgee, subset = sub, 
    R = R, family = Gamma(link = log), corstr = "fixed")

Summary of Residuals:
       Min         1Q     Median         3Q        Max 
-8.3423135 -3.0545513 -0.6859899  2.2598854 12.7656153 


Coefficients:
               Estimate Naive S.E.   Naive z Robust S.E.  Robust z
(Intercept)  3.11365042 0.44562056  6.987223  0.33999983  9.157800
x2          -0.09008311 0.04002263 -2.250804  0.04218714 -2.135322
x4          -0.08356337 0.03655400 -2.286025  0.03547845 -2.355328

Estimated Scale Parameter:  0.5550169
Number of Iterations:  4

Working Correlation
     [,1] [,2] [,3] [,4]
[1,]  1.0  0.2  0.3  0.1
[2,]  0.2  1.0  0.2  0.3
[3,]  0.3  0.2  1.0  0.2
[4,]  0.1  0.3  0.2  1.0
> 
